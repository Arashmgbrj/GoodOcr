<div dir="rtl" class="ocr-container">
  <!-- ูุฏุฑ ุณูโุจุนุฏ ุญุฑููโุง -->
  <header class="header-3d">
    <div class="header-background">
      <div class="floating-shapes">
        <div class="shape shape-1"></div>
        <div class="shape shape-2"></div>
        <div class="shape shape-3"></div>
        <div class="shape shape-4"></div>
        <div class="shape shape-5"></div>
      </div>
    </div>
    
    <nav class="nav-3d">
      <div class="nav-container">
        <!-- ููฺฏู ุณูโุจุนุฏ -->
        <a routerLink="/" class="logo-3d">
          <div class="logo-inner">
            <div class="logo-face logo-front">
              <i class="fas fa-eye"></i>
            </div>
            <div class="logo-face logo-back">
              <i class="fas fa-text-height"></i>
            </div>
            <div class="logo-face logo-top"></div>
            <div class="logo-face logo-bottom"></div>
            <div class="logo-face logo-left"></div>
            <div class="logo-face logo-right"></div>
          </div>
          <span class="logo-text">OCR VISION</span>
        </a>

        <!-- ุฏฺฉูู ุจุงุฒฺฏุดุช -->
        <a routerLink="/" class="back-btn-3d">
          <div class="btn-inner">
            <i class="fas fa-home"></i>
            <span>ุจุงุฒฺฏุดุช ุจู ุฎุงูู</span>
          </div>
          <div class="btn-shadow"></div>
        </a>
      </div>
    </nav>
  </header>

  <!-- ูุญุชูุง ุงุตู -->
  <main class="main-content-3d">
    <!-- ฺฉุงุฑุช ูุฑู ุณูโุจุนุฏ -->
    <div class="form-container-3d">
      <div class="card-3d">
        <div class="card-face card-front">
          <div class="card-header-3d">
            <div class="header-icon">
              <i class="fas fa-rocket"></i>
            </div>
            <h2 class="card-title">ุงุณุชุฎุฑุงุฌ ููุดููุฏ ูุชู</h2>
            <p class="card-subtitle">Smart Text Extraction</p>
          </div>

          <form [formGroup]="ocrForm" (ngSubmit)="onSubmit()" class="ocr-form-3d">
            <!-- ุงูุชุฎุงุจ ุฒุจุงู ุจุง ฺฺฉโุจุงฺฉุณ ูุงูุน -->
            <div class="language-section">
              <div class="section-header">
                <i class="fas fa-globe-americas"></i>
                <h3>ุงูุชุฎุงุจ ุฒุจุงู / Select Language</h3>
                <span class="selection-info">(ูโุชูุงูุฏ ูุฑ ุฏู ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ / You can select both)</span>
              </div>
              
              <div class="checkbox-group">
                <!-- ฺฺฉโุจุงฺฉุณ ูุงุฑุณ -->
                <label class="checkbox-label" [class.selected]="selectedLanguages.includes('fas')">
                  <input type="checkbox" 
                         value="fas"
                         [checked]="selectedLanguages.includes('fas')"
                         (change)="onLanguageToggle($event, 'fas')"
                         
                         class="checkbox-input">
                  <span class="checkbox-custom">
                    <i class="fas fa-check check-icon"></i>
                  </span>
                  <span class="checkbox-content">
                    <span class="language-flag">๐ฎ๐ท</span>
                    <span class="language-text">
                      <strong>ูุงุฑุณ / Persian</strong>
                      <span class="language-desc">ูุชู ูุงุฑุณ ุฑุง ุงุณุชุฎุฑุงุฌ ฺฉู</span>
                    </span>
                  </span>
                </label>

                <!-- ฺฺฉโุจุงฺฉุณ ุงูฺฏูุณ -->
                <label class="checkbox-label" [class.selected]="selectedLanguages.includes('eng')">
                  <input type="checkbox" 
                         value="eng"
                         [checked]="selectedLanguages.includes('eng')"
                         (change)="onLanguageToggle($event, 'eng')"
                         
                         class="checkbox-input">
                  <span class="checkbox-custom">
                    <i class="fas fa-check check-icon"></i>
                  </span>
                  <span class="checkbox-content">
                    <span class="language-flag">๐บ๐ธ</span>
                    <span class="language-text">
                      <strong>ุงูฺฏูุณ / English</strong>
                      <span class="language-desc">Extract English text</span>
                    </span>
                  </span>
                </label>
              </div>

              <!-- ููุงุด ุฒุจุงูโูุง ุงูุชุฎุงุจ ุดุฏู -->
              <div *ngIf="selectedLanguages.length > 0" class="selected-languages-display">
                <div class="selected-badge">
                  <i class="fas fa-check-circle"></i>
                  <span>
                    ุฒุจุงูโูุง ุงูุชุฎุงุจ ุดุฏู: 
                    <strong>{{ getSelectedLanguagesText() }}</strong>
                  </span>
                </div>
                <div class="selection-hint" *ngIf="selectedLanguages.length === 2">
                  <i class="fas fa-info-circle"></i>
                  ูุฑ ุฏู ุฒุจุงู ุงูุชุฎุงุจ ุดุฏูโุงูุฏ - ุณุณุชู ุจู ุทูุฑ ุฎูุฏฺฉุงุฑ ุชุดุฎุต ูโุฏูุฏ
                </div>
              </div>

              <!-- ููุงุด ุฎุทุง -->
              <div *ngIf="selectedLanguages.length === 0 && ocrForm.get('language')?.touched" 
                   class="error-message">
                <i class="fas fa-exclamation-triangle"></i>
                ูุทูุง ุญุฏุงูู ฺฉ ุฒุจุงู ุงูุชุฎุงุจ ฺฉูุฏ / Please select at least one language
              </div>
            </div>

            <!-- ุจุฎุด ุขูพููุฏ ุชุตูุฑ -->
            <div class="upload-section-3d">
              <div class="section-header">
                <i class="fas fa-cloud-upload-alt"></i>
                <h3>ุขูพููุฏ ุชุตูุฑ / Upload Image</h3>
              </div>
              
              <div class="upload-box-3d" [class.has-file]="selectedFile">
                <!-- ุขฺฉูู ุงุตู -->
                <div class="upload-icon-main">
                  <i class="fas fa-cloud-upload-alt"></i>
                </div>
                
                <!-- ูุชู ุฑุงูููุง -->
                <div class="upload-text" *ngIf="!selectedFile">
                  <h3>ุจุฑุง ุงุณุชุฎุฑุงุฌ ูุชู ุชุตูุฑ ุฎูุฏ ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ</h3>
                  <p>Select your image for text extraction</p>
                  <p class="file-size-info">ูุฑูุชโูุง ูพุดุชุจุงู ุดุฏู: JPG, PNG, JPEG | Max: 10MB</p>
                </div>

                <!-- ูพุดููุงุด ูุงู -->
                <div class="file-preview-box" *ngIf="selectedFile">
                  <div class="preview-header">
                    <i class="fas fa-check-circle success-icon"></i>
                    <span>ูุงู ุงูุชุฎุงุจ ุดุฏู / File Selected</span>
                  </div>
                  <div class="file-details">
                    <i class="fas fa-file-image file-type-icon"></i>
                    <div class="file-info">
                      <strong>{{ selectedFile.name }}</strong>
                      <span>{{ getFileSize(selectedFile.size) }}</span>
                    </div>
                  </div>
                </div>

                <!-- ุฏฺฉูู ุงูุชุฎุงุจ ูุงู -->
                <button type="button" class="upload-btn-3d" (click)="triggerFileInput()">
                  <i class="fas fa-folder-open"></i>
                  {{ selectedFile ? 'ุชุบุฑ ุชุตูุฑ / Change Image' : 'ุงูุชุฎุงุจ ุชุตูุฑ / Select Image' }}
                </button>
                
                <input #fileInput type="file" (change)="onFileChange($event)" style="opacity: 0;"
                       accept="image/*" class="file-input-hidden">
              </div>

              <!-- ุฏฺฉูู ุญุฐู ูุงู -->
              <button type="button" class="remove-file-btn" *ngIf="selectedFile" 
                      (click)="removeFile()">
                <i class="fas fa-trash"></i>
                ุญุฐู ูุงู / Remove File
              </button>
            </div>

            <!-- ุฏฺฉูู ุงุฑุณุงู -->
            <button type="submit" class="submit-btn-3d" 
                    [disabled]="selectedLanguages.length === 0 || !selectedFile || isLoading">
              <div class="btn-content-3d">
                <div class="btn-icon" *ngIf="!isLoading">
                  <i class="fas fa-bolt"></i>
                </div>
                <div class="btn-icon loading" *ngIf="isLoading">
                  <i class="fas fa-spinner fa-spin"></i>
                </div>
                <span class="btn-text">
                  {{ isLoading ? 'ุฏุฑ ุญุงู ูพุฑุฏุงุฒุด... / Processing...' : 'ุงุณุชุฎุฑุงุฌ ูุชู / Extract Text' }}
                </span>
              </div>
              <div class="btn-glow"></div>
            </button>
          </form>
        </div>
        
        <!-- ุงุถุงูู ฺฉุฑุฏู ุณุทูุญ ุณูโุจุนุฏ ฺฉุงุฑุช -->
        <div class="card-face card-back"></div>
        <div class="card-face card-top"></div>
        <div class="card-face card-bottom"></div>
        <div class="card-face card-left"></div>
        <div class="card-face card-right"></div>
      </div>
    </div>

    <!-- ูุชุงุฌ ุณูโุจุนุฏ - ุฎุงุฑุฌ ุงุฒ ฺฉุงุฑุช ุงุตู -->
    <div *ngIf="isfetch" class="results-section-3d" >
      <div class="results-container-3d">
        <div class="results-header-3d">
          <div class="results-title">
            <i class="fas fa-star-of-life"></i>
            <h2>ูุชุงุฌ ุงุณุชุฎุฑุงุฌ / Extraction Results</h2>
            <span class="results-badge">{{ results.length }} ูุชุฌู / results</span>
          </div>
        </div>

        <div class="results-grid-3d" >
          <div *ngFor="let result of results; let i = index" 
               class="result-card-3d"
               [style.animation-delay]="i * 0.1 + 's'">
            <div class="result-header">
              <div class="result-number">
                <span>#{{ i + 1 }}</span>
              </div>
              <h3>ูุชุฌู {{ persianNumbers[i] }} / Result {{ i + 1 }}</h3>
              <button class="copy-btn-3d" (click)="copyToClipboard(result.text)">
                <i class="fas fa-copy"></i>
              </button>
            </div>
            <div class="result-content">
              <textarea class="result-textarea-3d" readonly>{{ result.text }}</textarea>
            </div>
            <div class="result-footer">
              <span class="char-count">{{ result.text.length }} ฺฉุงุฑุงฺฉุชุฑ / characters</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>

  <!-- ุงุณูพูุฑ ุณูโุจุนุฏ -->
  <div *ngIf="isLoading" class="loading-3d" style="height: 300vh;">
    <div class="spinner-3d">
      <div class="spinner-core"></div>
      <div class="spinner-ring ring-1"></div>
      <div class="spinner-ring ring-2"></div>
      <div class="spinner-ring ring-3"></div>
      <div class="spinner-text">
        <h3>ุฏุฑ ุญุงู ุชุญูู ุชุตูุฑ / Analyzing Image</h3>
        <p>ูุทูุง ฺูุฏ ูุญุธู ุตุจุฑ ฺฉูุฏ... / Please wait a moment...</p>
      </div>
    </div>
  </div>

  <!-- ุงูฺฉุชโูุง ูพุณโุฒููู -->
  <div class="background-effects">
    <div class="particles-container">
      <div *ngFor="let particle of particles" class="particle"
           [style]="particle.style"></div>
    </div>
  </div>
</div>